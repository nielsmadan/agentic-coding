# Codex CLI permission rules
# Replicates Claude Code read-only git policy

# =============================================================================
# ALLOWED: Read-only git commands
# =============================================================================

prefix_rule(
    pattern = ["git", "status"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "log"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "diff"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "show"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "branch"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "remote", "-v"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "remote", "show"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "fetch"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "ls-files"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "ls-tree"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "rev-parse"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "rev-list"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "describe"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "blame"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "shortlog"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "stash", "list"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "tag", "-l"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "tag", "--list"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "config", "--get"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "config", "--list"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "cat-file"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "for-each-ref"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "name-rev"],
    decision = "allow"
)

prefix_rule(
    pattern = ["git", "reflog"],
    decision = "allow"
)

# =============================================================================
# ALLOWED: File inspection commands
# =============================================================================

prefix_rule(
    pattern = ["ls"],
    decision = "allow"
)

prefix_rule(
    pattern = ["pwd"],
    decision = "allow"
)

prefix_rule(
    pattern = ["which"],
    decision = "allow"
)

prefix_rule(
    pattern = ["whoami"],
    decision = "allow"
)

prefix_rule(
    pattern = ["cat"],
    decision = "allow"
)

prefix_rule(
    pattern = ["head"],
    decision = "allow"
)

prefix_rule(
    pattern = ["tail"],
    decision = "allow"
)

prefix_rule(
    pattern = ["less"],
    decision = "allow"
)

prefix_rule(
    pattern = ["more"],
    decision = "allow"
)

prefix_rule(
    pattern = ["find"],
    decision = "allow"
)

prefix_rule(
    pattern = ["grep"],
    decision = "allow"
)

prefix_rule(
    pattern = ["rg"],
    decision = "allow"
)

prefix_rule(
    pattern = ["wc"],
    decision = "allow"
)

prefix_rule(
    pattern = ["du"],
    decision = "allow"
)

prefix_rule(
    pattern = ["df"],
    decision = "allow"
)

prefix_rule(
    pattern = ["date"],
    decision = "allow"
)

prefix_rule(
    pattern = ["uptime"],
    decision = "allow"
)

prefix_rule(
    pattern = ["uname"],
    decision = "allow"
)

prefix_rule(
    pattern = ["env"],
    decision = "allow"
)

prefix_rule(
    pattern = ["printenv"],
    decision = "allow"
)

prefix_rule(
    pattern = ["file"],
    decision = "allow"
)

prefix_rule(
    pattern = ["stat"],
    decision = "allow"
)

prefix_rule(
    pattern = ["tree"],
    decision = "allow"
)

prefix_rule(
    pattern = ["realpath"],
    decision = "allow"
)

prefix_rule(
    pattern = ["dirname"],
    decision = "allow"
)

prefix_rule(
    pattern = ["basename"],
    decision = "allow"
)

prefix_rule(
    pattern = ["jq"],
    decision = "allow"
)

# =============================================================================
# ALLOWED: Version checks
# =============================================================================

prefix_rule(
    pattern = ["yarn", "--version"],
    decision = "allow"
)

prefix_rule(
    pattern = ["npm", "--version"],
    decision = "allow"
)

prefix_rule(
    pattern = ["node", "--version"],
    decision = "allow"
)

prefix_rule(
    pattern = ["python", "--version"],
    decision = "allow"
)

prefix_rule(
    pattern = ["ruby", "--version"],
    decision = "allow"
)

# =============================================================================
# DENIED: State-modifying git commands
# =============================================================================

prefix_rule(
    pattern = ["git", "add"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "commit"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "push"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "pull"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "merge"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "rebase"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "reset"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "checkout"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "switch"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "restore"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "cherry-pick"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "revert"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "stash", "push"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "stash", "pop"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "stash", "drop"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "stash", "apply"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "stash", "clear"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "branch", "-d"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "branch", "-D"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "branch", "-m"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "branch", "-M"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "tag", "-d"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "tag", "-a"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "remote", "add"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "remote", "remove"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "remote", "rm"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "remote", "rename"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "clean"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "rm"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "mv"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "init"],
    decision = "forbidden"
)

prefix_rule(
    pattern = ["git", "clone"],
    decision = "forbidden"
)
